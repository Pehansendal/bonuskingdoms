(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1767:function(e,r,s){Promise.resolve().then(s.bind(s,1363))},1363:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return d}});var a=s(3827),t=s(4090),n=s(2111),i=s(9157);function l(e){let{onLogin:r}=e,[s,n]=(0,t.useState)(""),[l,o]=(0,t.useState)(""),[d,c]=(0,t.useState)(""),u=async e=>{e.preventDefault();let{data:a,error:t}=await i.O.auth.signInWithPassword({email:s,password:l});t?c(t.message):r()};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-gray-800 p-8 rounded-lg shadow-lg w-96",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Admin Login"}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Brukernavn"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>n(e.target.value),className:"w-full p-2 rounded bg-gray-700 border border-gray-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Passord"}),(0,a.jsx)("input",{type:"password",value:l,onChange:e=>o(e.target.value),className:"w-full p-2 rounded bg-gray-700 border border-gray-600"})]}),d&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:d}),(0,a.jsx)("button",{type:"submit",className:"w-full py-2 bg-green-600 rounded-lg font-bold hover:bg-green-700",children:"Logg inn"})]})]})})}var o=s(7907);function d(){(0,o.useRouter)();let[e,r]=(0,t.useState)(!1),[s,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(!1),[g,m]=(0,t.useState)({id:"",name:"",bonus:"",short_description:"",affiliate_link:"",features:[""],terms:"",position:1,logo:"",rating:5});async function x(){let{data:e}=await i.O.from("casinos").select("*").order("position");e&&d(e)}async function b(e){if(!e.destination)return;let r=Array.from(s),[a]=r.splice(e.source.index,1);r.splice(e.destination.index,0,a);let t=r.map((e,r)=>({...e,position:r+1}));for(let e of(d(t),t))await i.O.from("casinos").update({position:e.position}).eq("id",e.id)}async function p(e){e.preventDefault();try{if(c){let{error:e}=await i.O.from("casinos").update({name:g.name,logo:g.logo,bonus:g.bonus,short_description:g.short_description,affiliate_link:g.affiliate_link,features:g.features,terms:g.terms,rating:g.rating,position:g.position}).eq("id",g.id);if(e){console.error("Error updating casino:",e),alert("Feil ved oppdatering av casino");return}}else{let e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let r=16*Math.random()|0;return("x"===e?r:3&r|8).toString(16)}),{data:r}=await i.O.from("casinos").select("position").order("position",{ascending:!1}).limit(1),s=r&&r[0]?r[0].position+1:1,{error:a}=await i.O.from("casinos").insert([{id:e,name:g.name,logo:g.logo,bonus:g.bonus,short_description:g.short_description,affiliate_link:g.affiliate_link,features:g.features.filter(e=>""!==e.trim()),terms:g.terms,rating:g.rating,position:s}]);if(a){console.error("Error adding casino:",a),alert("Feil ved opprettelse av casino");return}}await x(),m({id:"",name:"",bonus:"",short_description:"",affiliate_link:"",features:[""],terms:"",position:s.length+2,logo:"",rating:5}),u(!1),alert(c?"Casino oppdatert!":"Nytt casino lagt til!")}catch(e){console.error("Error:",e),alert("Noe gikk galt. Sjekk konsollen for detaljer.")}}async function f(e){window.confirm("Er du sikker p\xe5 at du vil slette dette casinoet?")&&(await i.O.from("casinos").delete().eq("id",e),x())}(0,t.useEffect)(()=>{e&&x()},[e]);let h=(0,t.useCallback)(async e=>{try{var r;let s=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!s)return;if(!s.type.startsWith("image/")){alert("Kun bildefiler er tillatt");return}if(s.size>2097152){alert("Bildet m\xe5 v\xe6re mindre enn 2MB");return}alert("Laster opp bilde...");let a=s.name.split(".").pop(),t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2),".").concat(a),{data:n,error:l}=await i.O.storage.from("casino-logos").upload(t,s,{cacheControl:"3600",upsert:!1});if(l)throw console.error("Upload error:",l),l;let{data:{publicUrl:o}}=i.O.storage.from("casino-logos").getPublicUrl(t);m(e=>({...e,logo:o})),alert("Bilde lastet opp!")}catch(e){console.error("Error uploading image:",e),alert("Feil ved opplasting av bilde. Sjekk konsollen for detaljer.")}},[]);return e?(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Casino Admin"}),(0,a.jsx)("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-red-600 rounded hover:bg-red-700",children:"Logg ut"})]}),(0,a.jsx)(n.Z5,{onDragEnd:b,children:(0,a.jsx)(n.bK,{droppableId:"casinos",children:e=>(0,a.jsxs)("div",{...e.droppableProps,ref:e.innerRef,className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Eksisterende Casinoer (dra for \xe5 endre rekkef\xf8lge)"}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 space-y-2",children:[s.map((e,r)=>(0,a.jsx)(n._l,{draggableId:e.id,index:r,children:r=>(0,a.jsxs)("div",{ref:r.innerRef,...r.draggableProps,...r.dragHandleProps,className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("img",{src:e.logo,alt:e.name,className:"w-12 h-12 object-contain"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.short_description})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{m({id:e.id||"",name:e.name||"",bonus:e.bonus||"",short_description:e.short_description||"",affiliate_link:e.affiliate_link||"",features:e.features||[""],terms:e.terms||"",position:e.position||1,logo:e.logo||"",rating:e.rating||5}),u(!0),window.scrollTo(0,document.body.scrollHeight)},className:"px-3 py-1 bg-blue-600 rounded hover:bg-blue-700",children:"Rediger"}),(0,a.jsx)("button",{onClick:()=>f(e.id),className:"px-3 py-1 bg-red-600 rounded hover:bg-red-700",children:"Slett"})]})]})},e.id)),e.placeholder]})]})})}),(0,a.jsxs)("div",{className:"mt-12 bg-gray-800/50 rounded-xl p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6",children:c?"Rediger Casino":"Legg til nytt casino"}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Casino Navn"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.name,onChange:e=>m({...g,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Logo"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[g.logo&&(0,a.jsx)("img",{src:g.logo,alt:"Preview",className:"w-24 h-24 object-contain bg-gray-900 rounded-lg p-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:h,className:"w-full p-2 rounded bg-gray-700 border border-gray-600"}),(0,a.jsx)("input",{type:"text",value:g.logo,onChange:e=>m({...g,logo:e.target.value}),placeholder:"eller lim inn bilde-URL",className:"w-full mt-2 p-2 rounded bg-gray-700 border border-gray-600"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Bonus"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.bonus,onChange:e=>m({...g,bonus:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Kort Beskrivelse"}),(0,a.jsx)("textarea",{className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.short_description,onChange:e=>m({...g,short_description:e.target.value}),required:!0,rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Affiliate Link"}),(0,a.jsx)("input",{type:"url",className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.affiliate_link,onChange:e=>m({...g,affiliate_link:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Features"}),g.features.map((e,r)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",className:"flex-grow p-2 rounded bg-gray-700 border border-gray-600",value:e,onChange:e=>{let s=[...g.features];s[r]=e.target.value,m({...g,features:s})}}),r===g.features.length-1?(0,a.jsx)("button",{type:"button",onClick:()=>m({...g,features:[...g.features,""]}),className:"px-4 py-2 bg-green-600 rounded hover:bg-green-700",children:"+"}):(0,a.jsx)("button",{type:"button",onClick:()=>{let e=g.features.filter((e,s)=>s!==r);m({...g,features:e})},className:"px-4 py-2 bg-red-600 rounded hover:bg-red-700",children:"-"})]},r))]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Terms"}),(0,a.jsx)("input",{type:"text",className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.terms,onChange:e=>m({...g,terms:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2",children:"Rating (1-5)"}),(0,a.jsx)("input",{type:"number",min:"1",max:"5",step:"0.1",className:"w-full p-2 rounded bg-gray-700 border border-gray-600",value:g.rating,onChange:e=>m({...g,rating:parseFloat(e.target.value)}),required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 py-3 bg-green-600 rounded-lg font-bold hover:bg-green-700",children:c?"Oppdater Casino":"Legg til Casino"}),c&&(0,a.jsx)("button",{type:"button",onClick:()=>{u(!1),m({id:"",name:"",bonus:"",short_description:"",affiliate_link:"",features:[""],terms:"",position:s.length+1,logo:"",rating:5})},className:"flex-1 py-3 bg-gray-600 rounded-lg font-bold hover:bg-gray-700",children:"Avbryt"})]})]})]})]}):(0,a.jsx)(l,{onLogin:()=>r(!0)})}},9157:function(e,r,s){"use strict";s.d(r,{O:function(){return i}});var a=s(9377);let t="https://kqaxbxwkqsszqehiyhna.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtxYXhieHdrcXNzenFlaGl5aG5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY4MTIzMzgsImV4cCI6MjA1MjM4ODMzOH0.M1HvIkO-ME09rImNVtFE49Csexa_Y2VmwchdRJ_k84o";if(!t||!n)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");let i=(0,a.eI)(t,n)}},function(e){e.O(0,[216,377,309,971,69,744],function(){return e(e.s=1767)}),_N_E=e.O()}]);